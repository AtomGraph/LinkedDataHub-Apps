@prefix :	    <#> .
@prefix ns:     <ns#> .
@prefix ldh:	<https://w3id.org/atomgraph/linkeddatahub#> .
@prefix rdfs:	<http://www.w3.org/2000/01/rdf-schema#> .
@prefix sp:	    <http://spinrdf.org/sp#> .
@prefix spin:	<http://spinrdf.org/spin#> .
@prefix dct:	<http://purl.org/dc/terms/> .
@prefix schema: <https://schema.org/> .

# orders from this customer

schema:Corporation ldh:template ns:OrdersFromCustomer .

ns:OrdersFromCustomer a ldh:View ;
    dct:title "Orders from this customer" ;
    spin:query ns:SelectOrdersFromCustomer ;
    rdfs:isDefinedBy ns: .

ns:SelectOrdersFromCustomer a sp:Select ;
    rdfs:label "Select orders from customer" ;
    sp:text """
PREFIX schema: <https://schema.org/>

SELECT DISTINCT ?order
WHERE
  { GRAPH ?graph
      { ?order schema:customer $about }
  }
ORDER BY DESC(?order)
""" ;
    rdfs:isDefinedBy ns: .

# products supplied by this supplier

schema:Corporation ldh:template ns:ProductsFromSupplier .

ns:ProductsFromSupplier a ldh:View ;
    dct:title "Products supplied by this supplier" ;
    spin:query ns:SelectProductsFromSupplier ;
    rdfs:isDefinedBy ns: .

ns:SelectProductsFromSupplier a sp:Select ;
    rdfs:label "Select products from supplier" ;
    sp:text """
PREFIX schema: <https://schema.org/>

SELECT DISTINCT ?product
WHERE
  { GRAPH ?graph
      { ?product schema:provider $about }
  }
ORDER BY ?product
""" ;
    rdfs:isDefinedBy ns: .
